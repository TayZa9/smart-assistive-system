<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Assistive Vision</title>
    <link rel="stylesheet" href="/static/css/styles.css?v=11">
    <link rel="stylesheet" href="/static/css/auth.css?v=2">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0"
        rel="stylesheet">
</head>

<body>
    <!-- Ambient background blobs -->
    <div class="ambient-bg">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <div class="auth-container fade-in">
        <div class="logo-icon large"
            style="margin: 0 auto; width: 64px; height: 64px; border-radius: 50%; background: linear-gradient(135deg, rgba(187,134,252,0.2) 0%, rgba(126,87,194,0.2) 100%); display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; border: 1px solid rgba(187,134,252,0.3);">
            <span class="material-symbols-rounded" style="color: #bb86fc; font-size: 32px;">visibility</span>
        </div>

        <!-- LOGIN FORM -->
        <div id="login-view">
            <h2>Welcome Back</h2>
            <p>Sign in to your Assistive Vision system.</p>

            <form class="auth-form" id="login-form">
                <input type="email" id="login-email" class="glass-input fade-in" style="animation-delay: 0.1s"
                    placeholder="Email Address" required>
                <input type="password" id="login-password" class="glass-input fade-in" style="animation-delay: 0.2s"
                    placeholder="Password" required>
                <div id="login-error" class="error-msg"></div>
                <button type="submit" class="primary-btn fade-in" style="animation-delay: 0.3s">Log In</button>
            </form>

            <div class="divider fade-in" style="animation-delay: 0.4s">OR</div>

            <a href="/auth/google" class="google-btn fade-in" style="animation-delay: 0.5s">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                    <path fill="#EA4335"
                        d="M24 9.5c3.1 0 5.9 1.1 8.1 2.9l6-6C34.5 2.7 29.5 0 24 0 14.8 0 6.9 5.3 3 13.1l7.3 5.7C12.1 13.6 17.6 9.5 24 9.5z" />
                    <path fill="#34A853"
                        d="M46.1 24.5c0-1.6-.1-3.2-.4-4.7H24v9h12.5c-.5 2.9-2.2 5.4-4.8 7l7.6 5.9c4.4-4.1 7-10.2 7-16.2z" />
                    <path fill="#4A90E2"
                        d="M10.3 28.8C9.9 27.2 9.6 25.6 9.6 24s.3-3.2.7-4.8l-7.3-5.7C1.1 16.9 0 20.4 0 24s1.1 7.1 3 10.5l7.3-5.7z" />
                    <path fill="#FBBC05"
                        d="M24 48c6.5 0 11.9-2.1 15.8-5.8l-7.6-5.9c-2.1 1.4-4.9 2.2-8.2 2.2-6.4 0-11.9-4.1-13.7-9.3l-7.3 5.7C6.9 42.7 14.8 48 24 48z" />
                </svg>
                Sign in with Google
            </a>

            <p class="fade-in" style="animation-delay: 0.6s; margin-top: 1.5rem; margin-bottom: 0;">
                Don't have an account? <a href="/signup" class="toggle-link">Sign Up</a>
            </p>
        </div>

    </div>

    <script>

        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorDiv = document.getElementById('login-error');
            const submitBtn = document.querySelector('#login-form button');

            submitBtn.disabled = true;
            submitBtn.textContent = 'Logging In...';

            try {
                const res = await fetch('/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                const data = await res.json();

                if (res.ok) {
                    window.location.href = '/';
                } else {
                    errorDiv.textContent = data.detail || 'Invalid email or password.';
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Log In';
                }
            } catch (err) {
                errorDiv.textContent = 'A network error occurred.';
                submitBtn.disabled = false;
                submitBtn.textContent = 'Log In';
            }
        });
    </script>
</body>

</html>